"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.DIALECT_FEATURES = exports.DSQL_FEATURES = exports.NILE_FEATURES = exports.COCKROACHDB_FEATURES = exports.POSTGRES_FEATURES = void 0;
const POSTGRES_SUPPORTED_TYPES = new Set([
    'SMALLINT', 'INT2', 'INTEGER', 'INT', 'INT4', 'BIGINT', 'INT8',
    'DECIMAL', 'NUMERIC', 'REAL', 'FLOAT4', 'DOUBLE PRECISION', 'FLOAT8',
    'SMALLSERIAL', 'SERIAL', 'SERIAL4', 'BIGSERIAL', 'SERIAL8',
    'MONEY',
    'CHARACTER VARYING', 'VARCHAR', 'CHARACTER', 'CHAR', 'TEXT',
    'BYTEA',
    'TIMESTAMP', 'TIMESTAMP WITHOUT TIME ZONE', 'TIMESTAMPTZ', 'TIMESTAMP WITH TIME ZONE',
    'DATE', 'TIME', 'TIME WITHOUT TIME ZONE', 'TIMETZ', 'TIME WITH TIME ZONE',
    'INTERVAL',
    'BOOLEAN', 'BOOL',
    'POINT', 'LINE', 'LSEG', 'BOX', 'PATH', 'POLYGON', 'CIRCLE',
    'INET', 'CIDR', 'MACADDR', 'MACADDR8',
    'BIT', 'BIT VARYING', 'VARBIT',
    'TSVECTOR', 'TSQUERY',
    'UUID',
    'XML',
    'JSON', 'JSONB',
    'INT4RANGE', 'INT8RANGE', 'NUMRANGE', 'TSRANGE', 'TSTZRANGE', 'DATERANGE',
    'INT4MULTIRANGE', 'INT8MULTIRANGE', 'NUMMULTIRANGE', 'TSMULTIRANGE', 'TSTZMULTIRANGE', 'DATEMULTIRANGE',
    'OID', 'REGCLASS', 'REGPROC', 'REGTYPE', 'REGNAMESPACE', 'REGROLE',
    'PG_LSN',
    'PG_SNAPSHOT',
    'VECTOR', 'HALFVEC', 'SPARSEVEC',
    'GEOMETRY', 'GEOGRAPHY',
    'CITEXT', 'LTREE', 'LQUERY', 'LTXTQUERY', 'HSTORE', 'CUBE', 'SEMVER',
]);
exports.POSTGRES_FEATURES = {
    dialect: 'postgres',
    name: 'PostgreSQL',
    supportedTypes: POSTGRES_SUPPORTED_TYPES,
    unsupportedTypes: new Map(),
    typeAlternatives: new Map(),
    supportedIndexMethods: new Set(['btree', 'hash', 'gist', 'spgist', 'gin', 'brin']),
    supports: {
        foreignKeys: true,
        deferrableForeignKeys: true,
        triggers: true,
        functions: true,
        sequences: true,
        partitioning: true,
        materializedViews: true,
        exclusionConstraints: true,
        arrayColumns: true,
        generatedColumns: true,
        identityColumns: true,
        unloggedTables: true,
        temporaryTables: true,
        tableInheritance: true,
        listenNotify: true,
        advisoryLocks: true,
        rowLevelSecurity: true,
        domains: true,
        compositeTypes: true,
        enumTypes: true,
        extensions: true,
        nullsNotDistinct: true,
        notValidConstraints: true,
    },
    restrictions: [],
    docsUrl: 'https://www.postgresql.org/docs/current/',
};
const COCKROACHDB_UNSUPPORTED_TYPES = new Map([
    ['POINT', { reason: 'Geometric types not supported', alternative: 'Use JSONB to store GeoJSON or PostGIS-style coordinates' }],
    ['LINE', { reason: 'Geometric types not supported', alternative: 'Use JSONB to store line data' }],
    ['LSEG', { reason: 'Geometric types not supported', alternative: 'Use JSONB to store line segment data' }],
    ['BOX', { reason: 'Geometric types not supported', alternative: 'Use JSONB to store bounding box data' }],
    ['PATH', { reason: 'Geometric types not supported', alternative: 'Use JSONB to store path data' }],
    ['POLYGON', { reason: 'Geometric types not supported', alternative: 'Use JSONB to store polygon data' }],
    ['CIRCLE', { reason: 'Geometric types not supported', alternative: 'Use JSONB to store circle data' }],
    ['INT4RANGE', { reason: 'Range types not supported', alternative: 'Use two columns for min/max bounds' }],
    ['INT8RANGE', { reason: 'Range types not supported', alternative: 'Use two columns for min/max bounds' }],
    ['NUMRANGE', { reason: 'Range types not supported', alternative: 'Use two columns for min/max bounds' }],
    ['TSRANGE', { reason: 'Range types not supported', alternative: 'Use two columns for start/end timestamps' }],
    ['TSTZRANGE', { reason: 'Range types not supported', alternative: 'Use two columns for start/end timestamps' }],
    ['DATERANGE', { reason: 'Range types not supported', alternative: 'Use two columns for start/end dates' }],
    ['INT4MULTIRANGE', { reason: 'Multirange types not supported' }],
    ['INT8MULTIRANGE', { reason: 'Multirange types not supported' }],
    ['NUMMULTIRANGE', { reason: 'Multirange types not supported' }],
    ['TSMULTIRANGE', { reason: 'Multirange types not supported' }],
    ['TSTZMULTIRANGE', { reason: 'Multirange types not supported' }],
    ['DATEMULTIRANGE', { reason: 'Multirange types not supported' }],
    ['XML', { reason: 'XML type not supported', alternative: 'Use TEXT to store XML as string, or JSONB for structured data' }],
    ['MONEY', { reason: 'MONEY type not supported', alternative: 'Use DECIMAL(19,4) for monetary values' }],
    ['OID', { reason: 'OID type not supported' }],
    ['REGCLASS', { reason: 'REGCLASS type not supported' }],
    ['REGPROC', { reason: 'REGPROC type not supported' }],
    ['REGTYPE', { reason: 'REGTYPE type not supported' }],
    ['REGNAMESPACE', { reason: 'REGNAMESPACE type not supported' }],
    ['REGROLE', { reason: 'REGROLE type not supported' }],
    ['PG_LSN', { reason: 'PG_LSN type not supported' }],
    ['PG_SNAPSHOT', { reason: 'PG_SNAPSHOT type not supported' }],
    ['VECTOR', { reason: 'pgvector extension not supported', alternative: 'Use ARRAY of FLOAT or JSONB to store embeddings' }],
    ['HALFVEC', { reason: 'pgvector extension not supported', alternative: 'Use ARRAY of FLOAT or JSONB to store embeddings' }],
    ['SPARSEVEC', { reason: 'pgvector extension not supported', alternative: 'Use JSONB to store sparse vector data' }],
    ['GEOMETRY', { reason: 'PostGIS GEOMETRY not supported', alternative: 'Use CockroachDB native GEOMETRY type (different syntax)' }],
    ['GEOGRAPHY', { reason: 'PostGIS GEOGRAPHY not supported', alternative: 'Use CockroachDB native GEOGRAPHY type (different syntax)' }],
    ['CITEXT', { reason: 'CITEXT extension not supported', alternative: 'Use LOWER() function or case-insensitive collation' }],
    ['LTREE', { reason: 'LTREE extension not supported', alternative: 'Use TEXT with application-level path handling' }],
    ['LQUERY', { reason: 'LTREE extension not supported' }],
    ['LTXTQUERY', { reason: 'LTREE extension not supported' }],
    ['HSTORE', { reason: 'HSTORE extension not supported', alternative: 'Use JSONB instead' }],
    ['CUBE', { reason: 'CUBE extension not supported', alternative: 'Use ARRAY of FLOAT' }],
    ['SEMVER', { reason: 'SEMVER extension not supported', alternative: 'Use TEXT with application-level version parsing' }],
]);
const COCKROACHDB_SUPPORTED_TYPES = new Set([...POSTGRES_SUPPORTED_TYPES].filter(t => !COCKROACHDB_UNSUPPORTED_TYPES.has(t)));
exports.COCKROACHDB_FEATURES = {
    dialect: 'cockroachdb',
    name: 'CockroachDB',
    supportedTypes: COCKROACHDB_SUPPORTED_TYPES,
    unsupportedTypes: COCKROACHDB_UNSUPPORTED_TYPES,
    typeAlternatives: new Map([
        ['MONEY', 'DECIMAL(19,4)'],
        ['XML', 'TEXT'],
        ['POINT', 'JSONB'],
        ['LINE', 'JSONB'],
        ['LSEG', 'JSONB'],
        ['BOX', 'JSONB'],
        ['PATH', 'JSONB'],
        ['POLYGON', 'JSONB'],
        ['CIRCLE', 'JSONB'],
        ['VECTOR', 'FLOAT[]'],
        ['HALFVEC', 'FLOAT[]'],
        ['SPARSEVEC', 'JSONB'],
        ['HSTORE', 'JSONB'],
        ['CITEXT', 'TEXT'],
        ['LTREE', 'TEXT'],
    ]),
    supportedIndexMethods: new Set(['btree', 'hash', 'gin']),
    supports: {
        foreignKeys: true,
        deferrableForeignKeys: false,
        triggers: false,
        functions: true,
        sequences: true,
        partitioning: true,
        materializedViews: true,
        exclusionConstraints: false,
        arrayColumns: true,
        generatedColumns: true,
        identityColumns: true,
        unloggedTables: false,
        temporaryTables: true,
        tableInheritance: false,
        listenNotify: false,
        advisoryLocks: false,
        rowLevelSecurity: false,
        domains: false,
        compositeTypes: false,
        enumTypes: true,
        extensions: false,
        nullsNotDistinct: true,
        notValidConstraints: true,
    },
    restrictions: [
        'Geometric types (POINT, LINE, etc.) not supported - use JSONB for GeoJSON',
        'Range and multirange types not supported',
        'XML type not supported - use TEXT',
        'MONEY type not supported - use DECIMAL',
        'Triggers not supported',
        'DEFERRABLE constraints not supported',
        'LISTEN/NOTIFY not supported',
        'Table inheritance not supported',
        'UNLOGGED tables not supported (CockroachDB is always durable)',
        'PostgreSQL extensions not supported',
    ],
    docsUrl: 'https://www.cockroachlabs.com/docs/stable/',
};
const NILE_UNSUPPORTED_TYPES = new Map(Array.from(COCKROACHDB_UNSUPPORTED_TYPES.entries()));
const NILE_SUPPORTED_TYPES = new Set([...POSTGRES_SUPPORTED_TYPES].filter(t => !NILE_UNSUPPORTED_TYPES.has(t)));
exports.NILE_FEATURES = {
    dialect: 'nile',
    name: 'Nile',
    supportedTypes: NILE_SUPPORTED_TYPES,
    unsupportedTypes: NILE_UNSUPPORTED_TYPES,
    typeAlternatives: new Map([
        ['MONEY', 'DECIMAL(19,4)'],
        ['XML', 'TEXT'],
    ]),
    supportedIndexMethods: new Set(['btree', 'hash', 'gin', 'gist']),
    supports: {
        foreignKeys: true,
        deferrableForeignKeys: false,
        triggers: false,
        functions: false,
        sequences: true,
        partitioning: false,
        materializedViews: false,
        exclusionConstraints: false,
        arrayColumns: true,
        generatedColumns: true,
        identityColumns: true,
        unloggedTables: false,
        temporaryTables: true,
        tableInheritance: false,
        listenNotify: false,
        advisoryLocks: false,
        rowLevelSecurity: true,
        domains: false,
        compositeTypes: false,
        enumTypes: true,
        extensions: false,
        nullsNotDistinct: true,
        notValidConstraints: true,
    },
    restrictions: [
        'Triggers not supported',
        'Stored functions/procedures not supported',
        'Materialized views not supported',
        'Table partitioning managed by Nile tenant isolation',
        'Cross-tenant foreign keys have restrictions',
        'LISTEN/NOTIFY not supported',
        'Tenant tables must include tenant_id column',
    ],
    docsUrl: 'https://www.thenile.dev/docs/',
};
const DSQL_UNSUPPORTED_TYPES = new Map([
    ...COCKROACHDB_UNSUPPORTED_TYPES,
    ['TSVECTOR', { reason: 'Full-text search types not supported in DSQL', alternative: 'Use application-level search or AWS OpenSearch' }],
    ['TSQUERY', { reason: 'Full-text search types not supported in DSQL', alternative: 'Use application-level search or AWS OpenSearch' }],
    ['MACADDR8', { reason: 'MACADDR8 not supported in DSQL', alternative: 'Use MACADDR or TEXT' }],
]);
const DSQL_SUPPORTED_TYPES = new Set([...POSTGRES_SUPPORTED_TYPES].filter(t => !DSQL_UNSUPPORTED_TYPES.has(t)));
exports.DSQL_FEATURES = {
    dialect: 'dsql',
    name: 'AWS Aurora DSQL',
    supportedTypes: DSQL_SUPPORTED_TYPES,
    unsupportedTypes: DSQL_UNSUPPORTED_TYPES,
    typeAlternatives: new Map([
        ['MONEY', 'DECIMAL(19,4)'],
        ['XML', 'TEXT'],
        ['TSVECTOR', 'TEXT'],
        ['TSQUERY', 'TEXT'],
        ['MACADDR8', 'MACADDR'],
        ['VECTOR', 'JSONB'],
        ['HALFVEC', 'JSONB'],
        ['SPARSEVEC', 'JSONB'],
        ['HSTORE', 'JSONB'],
    ]),
    supportedIndexMethods: new Set(['btree']),
    supports: {
        foreignKeys: true,
        deferrableForeignKeys: false,
        triggers: false,
        functions: false,
        sequences: false,
        partitioning: false,
        materializedViews: false,
        exclusionConstraints: false,
        arrayColumns: true,
        generatedColumns: true,
        identityColumns: true,
        unloggedTables: false,
        temporaryTables: false,
        tableInheritance: false,
        listenNotify: false,
        advisoryLocks: false,
        rowLevelSecurity: false,
        domains: false,
        compositeTypes: false,
        enumTypes: true,
        extensions: false,
        nullsNotDistinct: true,
        notValidConstraints: true,
    },
    restrictions: [
        'Only B-tree indexes supported',
        'No triggers or stored functions',
        'No sequences (use SERIAL or application-generated IDs)',
        'No TEMPORARY tables',
        'No full-text search (TSVECTOR/TSQUERY)',
        'No LISTEN/NOTIFY',
        'Partitioning managed automatically by DSQL',
        'JSONB supported but without GIN indexes',
        'Maximum statement size: 16MB',
        'Maximum row size: 4MB',
    ],
    docsUrl: 'https://docs.aws.amazon.com/aurora-dsql/',
};
exports.DIALECT_FEATURES = new Map([
    ['postgres', exports.POSTGRES_FEATURES],
    ['cockroachdb', exports.COCKROACHDB_FEATURES],
    ['nile', exports.NILE_FEATURES],
    ['dsql', exports.DSQL_FEATURES],
]);
